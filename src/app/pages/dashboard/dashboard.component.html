<div class="min-h-screen bg-gray-50 p-4 md:p-8">
  <p-toast></p-toast>
  <div class="max-w-7xl mx-auto">
    <!-- Header -->
    <div class="mb-8">
      <h1 class="text-3xl font-bold text-gray-900 mb-2">Image Metrics Visualization Dashboard</h1>
      <p class="text-gray-600">Upload a JSON file to visualize PSNR, SSIM, and DeltaE metrics</p>
    </div>

    <!-- File Upload Section -->
    <div class="mb-8">
      <p-card>
        <p-fileUpload 
          mode="basic" 
          name="metricsFile"
          accept=".json"
          [maxFileSize]="1000000"
          [auto]="true"
          [multiple]="true"
          chooseLabel="Choose JSON File(s)"
          (onSelect)="onFileUpload($event)"
          styleClass="w-full"
        ></p-fileUpload>
      </p-card>
    </div>

    <!-- Charts Section -->
    <div *ngIf="metricsData.length > 0" class="space-y-8">
      <!-- PSNR Chart -->
      <div>
        <p-card>
          <ng-template pTemplate="header">
            <div class="p-4">
              <h2 class="text-2xl font-semibold text-gray-800">PSNR Comparison</h2>
              <p class="text-sm text-gray-600 mt-1">Peak Signal-to-Noise Ratio (Higher is Better)</p>
            </div>
          </ng-template>
          <div class="chart-container" style="height: 400px;">
            <p-chart type="bar" [data]="psnrChartData" [options]="chartOptions"></p-chart>
          </div>
        </p-card>
      </div>

      <!-- DeltaE Chart -->
      <div>
        <p-card>
          <ng-template pTemplate="header">
            <div class="p-4">
              <h2 class="text-2xl font-semibold text-gray-800">DeltaE Comparison</h2>
              <p class="text-sm text-gray-600 mt-1">Color Difference (Lower is Better)</p>
            </div>
          </ng-template>
          <div class="chart-container" style="height: 400px;">
            <p-chart type="bar" [data]="deltaEChartData" [options]="chartOptions"></p-chart>
          </div>
        </p-card>
      </div>

      <!-- Data Table -->
      <div>
        <p-card>
          <ng-template pTemplate="header">
            <div class="p-4">
              <h2 class="text-2xl font-semibold text-gray-800">Detailed Metrics Table</h2>
              <p class="text-sm text-gray-600 mt-1">Click column headers to sort</p>
            </div>
          </ng-template>
          <p-table 
            [value]="metricsData" 
            [tableStyle]="{'min-width': '50rem'}"
            styleClass="p-datatable-striped"
          >
            <ng-template pTemplate="header">
              <tr>
                <th pSortableColumn="imageName" class="text-left">
                  Image Name <p-sortIcon field="imageName"></p-sortIcon>
                </th>
                <th pSortableColumn="method" class="text-left">
                  Method <p-sortIcon field="method"></p-sortIcon>
                </th>
                <th pSortableColumn="psnr" class="text-right">
                  PSNR <p-sortIcon field="psnr"></p-sortIcon>
                </th>
                <th pSortableColumn="ssim" class="text-right">
                  SSIM <p-sortIcon field="ssim"></p-sortIcon>
                </th>
                <th pSortableColumn="deltaE" class="text-right">
                  DeltaE <p-sortIcon field="deltaE"></p-sortIcon>
                </th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-metric>
              <tr>
                <td class="text-left">{{ metric.imageName }}</td>
                <td class="text-left">
                  <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                    {{ metric.method }}
                  </span>
                </td>
                <td class="text-right font-mono">{{ metric.psnr | number:'1.2-2' }}</td>
                <td class="text-right font-mono">{{ metric.ssim | number:'1.2-4' }}</td>
                <td class="text-right font-mono">{{ metric.deltaE | number:'1.2-2' }}</td>
              </tr>
            </ng-template>
          </p-table>
        </p-card>
      </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="metricsData.length === 0" class="text-center py-12">
      <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-blue-100 mb-4">
        <i class="pi pi-upload text-2xl text-blue-600"></i>
      </div>
      <h3 class="text-lg font-medium text-gray-900 mb-2">No Data Available</h3>
      <p class="text-gray-600">Please upload a JSON file to visualize metrics</p>
    </div>
  </div>
</div>
